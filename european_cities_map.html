<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Top 50 Cities in Europe</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
            height: 100vh;
        }

        .map-title {
            position: absolute;
            top: 20px;
            left: 60px;
            background-color: rgba(255, 255, 255, 0.95);
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            z-index: 999;
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }

        .leaflet-control-scale {
            background-color: rgba(255, 255, 255, 0.9) !important;
        }

        .leaflet-control-scale-line {
            border: 2px solid #333 !important;
            border-top: none !important;
            color: #333 !important;
            font-size: 12px !important;
            padding: 2px 5px !important;
        }

        .legend {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            line-height: 1.8;
            font-size: 13px;
        }

        .legend h4 {
            margin: 0 0 10px 0;
            font-weight: bold;
            color: #333;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .legend-circle {
            height: 20px;
            width: 20px;
            background-color: #1f77b4;
            border-radius: 50%;
            margin-right: 10px;
            opacity: 0.7;
        }

        .legend-label {
            color: #555;
        }

        .north-arrow {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: rgba(255, 255, 255, 0.95);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            z-index: 999;
            font-size: 24px;
            color: #333;
            cursor: pointer;
        }

        .popup-content {
            font-size: 13px;
            color: #333;
        }

        .popup-content strong {
            color: #1f77b4;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <div class="map-title">Top 50 Cities in Europe</div>
    <div class="north-arrow" id="northArrow" title="Click to reset north">
        <i class="fas fa-arrow-up"></i>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    <script>
        // Initialize map
        const map = L.map('map').setView([54.5260, 15.2551], 3);

        // Add OSM basemap
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            maxZoom: 19
        }).addTo(map);

        // Top 50 most populated cities in Europe
        const cities = [
            { name: "Istanbul", lat: 41.0082, lng: 28.9784, population: 15462000 },
            { name: "Moscow", lat: 55.7558, lng: 37.6173, population: 12608000 },
            { name: "London", lat: 51.5074, lng: -0.1278, population: 9002000 },
            { name: "St. Petersburg", lat: 59.9311, lng: 30.3609, population: 5398000 },
            { name: "Berlin", lat: 52.5200, lng: 13.4050, population: 3645000 },
            { name: "Madrid", lat: 40.4168, lng: -3.7038, population: 3280000 },
            { name: "Rome", lat: 41.9028, lng: 12.4964, population: 2761000 },
            { name: "Paris", lat: 48.8566, lng: 2.3522, population: 2165000 },
            { name: "Vienna", lat: 48.2082, lng: 16.3738, population: 1920000 },
            { name: "Barcelona", lat: 41.3851, lng: 2.1734, population: 1610000 },
            { name: "Hamburg", lat: 53.5511, lng: 9.9937, population: 1850000 },
            { name: "Budapest", lat: 47.4979, lng: 19.0402, population: 1752000 },
            { name: "Warsaw", lat: 52.2297, lng: 21.0122, population: 1863000 },
            { name: "Milan", lat: 45.4642, lng: 9.1900, population: 1352000 },
            { name: "Athens", lat: 37.9838, lng: 23.7275, population: 3154000 },
            { name: "Prague", lat: 50.0755, lng: 14.4378, population: 1321000 },
            { name: "Lisbon", lat: 38.7223, lng: -9.1393, population: 1505000 },
            { name: "Munich", lat: 48.1351, lng: 11.5820, population: 1471000 },
            { name: "Cologne", lat: 50.9365, lng: 6.9589, population: 1086000 },
            { name: "Frankfurt", lat: 50.1109, lng: 8.6821, population: 746000 },
            { name: "Amsterdam", lat: 52.3676, lng: 4.9041, population: 873000 },
            { name: "Brussels", lat: 50.8503, lng: 4.3517, population: 1210000 },
            { name: "Naples", lat: 40.8518, lng: 14.2681, population: 909000 },
            { name: "Turin", lat: 45.0705, lng: 7.6868, population: 870000 },
            { name: "Zurich", lat: 47.3769, lng: 8.5472, population: 805000 },
            { name: "Bucharest", lat: 44.4268, lng: 26.1025, population: 1830000 },
            { name: "Sofia", lat: 42.6977, lng: 23.3219, population: 1242000 },
            { name: "Kyiv", lat: 50.4501, lng: 30.5234, population: 2962000 },
            { name: "Kraków", lat: 50.0647, lng: 19.9450, population: 769000 },
            { name: "Wrocław", lat: 51.1079, lng: 17.0385, population: 644000 },
            { name: "Valencia", lat: 39.4699, lng: -0.3763, population: 1606000 },
            { name: "Seville", lat: 37.3886, lng: -5.9823, population: 1532000 },
            { name: "Zaragoza", lat: 41.6488, lng: -0.8891, population: 676000 },
            { name: "Bilbao", lat: 43.2633, lng: -2.9349, population: 345000 },
            { name: "Palma", lat: 39.5696, lng: 2.6502, population: 401000 },
            { name: "Rotterdam", lat: 51.9225, lng: 4.4792, population: 585000 },
            { name: "Antwerp", lat: 51.2194, lng: 4.4025, population: 520000 },
            { name: "Marseille", lat: 43.2965, lng: 5.3698, population: 869000 },
            { name: "Lyon", lat: 45.7640, lng: 4.8357, population: 513000 },
            { name: "Toulouse", lat: 43.6047, lng: 1.4442, population: 479000 },
            { name: "Nice", lat: 43.7102, lng: 7.2620, population: 340000 },
            { name: "Venice", lat: 45.4408, lng: 12.3155, population: 261000 },
            { name: "Florence", lat: 43.7696, lng: 11.2558, population: 382000 },
            { name: "Genoa", lat: 44.4056, lng: 8.9463, population: 580000 },
            { name: "Palermo", lat: 38.1157, lng: 13.3615, population: 660000 },
            { name: "Bratislava", lat: 48.1486, lng: 17.1077, population: 440000 },
            { name: "Ljubljana", lat: 46.0569, lng: 14.5058, population: 296000 },
            { name: "Zagreb", lat: 45.8150, lng: 15.9819, population: 769000 },
            { name: "Belgrade", lat: 44.8176, lng: 20.4633, population: 1687000 }
        ];

        // Calculate circle radius based on population
        function getRadius(population) {
            return Math.sqrt(population / 31416) * 1.5;
        }

        // Add city circles to map
        cities.forEach(city => {
            const radius = getRadius(city.population);
            
            const circle = L.circle([city.lat, city.lng], {
                color: '#1f77b4',
                fillColor: '#1f77b4',
                fillOpacity: 0.7,
                weight: 2,
                radius: radius * 1000
            }).addTo(map);

            // Add popup on click
            const popupContent = `
                <div class="popup-content">
                    <strong>${city.name}</strong><br>
                    Population: ${city.population.toLocaleString()}
                </div>
            `;
            circle.bindPopup(popupContent);
        });

        // Add scale control
        L.control.scale({
            position: 'bottomleft',
            metric: true,
            imperial: true
        }).addTo(map);

        // Add legend
        const legend = L.control({ position: 'bottomright' });

        legend.onAdd = function(map) {
            const div = L.DomUtil.create('div', 'legend');
            div.innerHTML = `
                <h4>Population Size</h4>
                <div class="legend-item">
                    <div class="legend-circle" style="width: 15px; height: 15px;"></div>
                    <span class="legend-label">1 - 3 million</span>
                </div>
                <div class="legend-item">
                    <div class="legend-circle" style="width: 25px; height: 25px;"></div>
                    <span class="legend-label">3 - 8 million</span>
                </div>
                <div class="legend-item">
                    <div class="legend-circle" style="width: 40px; height: 40px;"></div>
                    <span class="legend-label">8+ million</span>
                </div>
                <hr style="margin: 10px 0; border: none; border-top: 1px solid #ccc;">
                <small style="color: #777;">Circle size represents population</small>
            `;
            return div;
        };

        legend.addTo(map);

        // North arrow functionality
        document.getElementById('northArrow').addEventListener('click', function() {
            map.setView([54.5260, 15.2551], 3);
        });
    </script>
</body>
</html>